<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>任务列表 | Task List</title>
    <!-- 引入 Element Plus CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus@2.7.0/dist/index.css">
    <!-- 引入 Vue.js -->
    <script src="https://unpkg.com/vue@3.3.0/dist/vue.global.js"></script>
    <!-- 引入 Element Plus -->
    <script src="https://unpkg.com/element-plus@2.7.0/dist/index.full.js"></script>
    <!-- 引入 Element Plus 图标 -->
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>
    <style>
        .app-container {
            background: var(--el-bg-color);
            border-radius: 8px;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .mb-12 {
            margin-bottom: 1.5rem;
        }
        
        .mb-4 {
            margin-bottom: 1.5rem;
        }
        
        .mb-3 {
            margin-bottom: 1rem;
        }
        
        .w-100 {
            width: 100%;
        }
        
        .text-center {
            text-align: center;
        }
        
        .text-secondary {
            color: var(--el-text-color-secondary);
        }
        /* 响应式调整 */
        
        @media (max-width: 768px) {
            .el-col {
                width: 100%;
                margin-bottom: 1rem;
            }
            .app-container {
                margin: 20px 10px;
                padding: 0 10px;
            }
        }
        /* Element Plus 优化 */
        
        .el-table {
            --el-table-border-color: var(--el-border-color-lighter);
            --el-table-header-bg-color: var(--el-bg-color-page);
        }
        
        .el-button {
            --el-button-hover-bg-color: var(--el-color-primary-light-3);
            --el-button-hover-text-color: var(--el-color-white);
        }
        
        .el-menu {
            background: transparent;
            border-bottom: none;
        }
        
        .el-affix {
            background: var(--el-bg-color);
            z-index: 1000;
            border-bottom: 1px solid var(--el-border-color-lighter);
        }
        /* Element UI 表格样式优化 */
    </style>
</head>

<body>
    <div class="app-container" style="max-width: 1200px; margin: 40px auto; padding: 0 20px;">
        <!-- 主要内容区 -->
        <div id="taskList" class="tasklist">
            <!-- 顶部导航栏 -->
            <!-- 顶部工具栏 -->
            <el-row :gutter="16" class="mb-4" style="align-items:center">
                <el-col :xs="24" :sm="12" :md="6">
                    <el-tooltip content="{{ LANG('Open documentation~打开文档') }}" placement="top">
                        <el-button type="info" class="w-100" @click.prevent="openExternal('https://github.com/dengbuliduo/ReliableSpider/wiki')" aria-label="{{ LANG('Open docs~打开文档') }}">
                            <el-icon style="margin-right:6px">
                                <document />
                            </el-icon>
                            <span>{{ LANG("Software Documentation~软件使用说明文档") }}</span>
                        </el-button>
                    </el-tooltip>
                </el-col>
                <el-col :xs="24" :sm="12" :md="6">
                    <el-tooltip content="{{ LANG('Open issues~打开问题列表') }}" placement="top">
                        <el-button type="info" class="w-100" @click.prevent="openExternal('https://github.com/dengbuliduo/ReliableSpider/issues?q=is%3Aissue')" aria-label="{{ LANG('Open issues~打开问题列表') }}">
                            <el-icon style="margin-right:6px">
                                <question-filled />
                            </el-icon>
                            <span>{{ LANG("Ask questions here~官方答疑平台") }}</span>
                        </el-button>
                    </el-tooltip>
                </el-col>
                <el-col :xs="24" :sm="12" :md="6">
                    <el-tooltip content="{{ LANG('Schedule tutorial~定时执行教程') }}" placement="top">
                        <el-button type="info" class="w-100" @click.prevent="openExternal('https://github.com/dengbuliduo/ReliableSpider/issues/22')" aria-label="{{ LANG('Schedule tutorial~定时执行教程') }}">
                            <el-icon style="margin-right:6px">
                                <timer />
                            </el-icon>
                            <span>{{ LANG("See how to run task by schedule~定时执行任务教程") }}</span>
                        </el-button>
                    </el-tooltip>
                </el-col>
                <el-col :xs="24" :sm="12" :md="6" style="text-align:right">
                    <el-dropdown @command="changeLang" trigger="click">
                        <el-button type="primary">
                            <span style="margin-right:8px">{{ lang === 'zh' ? '中文' : 'English' }}</span>
                            <el-icon class="el-icon--right">
                                <arrow-down />
                            </el-icon>
                        </el-button>
                        <template #dropdown>
                            <el-dropdown-menu>
                                <el-dropdown-item command="zh">
                                    <el-icon v-if="lang === 'zh'" style="margin-right:6px"><check /></el-icon>
                                    中文
                                </el-dropdown-item>
                                <el-dropdown-item command="en">
                                    <el-icon v-if="lang === 'en'" style="margin-right:6px"><check /></el-icon>
                                    English
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </template>
                    </el-dropdown>
                </el-col>
            </el-row>

            <div class="text-center mb-4">
                <h2 class="mb-3">{{ LANG("Task List~任务列表") }}</h2>
            </div>

            <!-- 主要操作按钮组 -->
            <el-row :gutter="20" class="mb-4">
                <el-col :span="8">
                    <el-button type="primary" @click="newTask" size="large" class="w-100">
                        <el-icon>
                            <plus />
                        </el-icon>
                        {{ LANG("New Task~创建新任务") }}
                    </el-button>
                </el-col>
                <el-col :span="8">
                    <el-button type="success" @click="startDesign(lang)" size="large" class="w-100">
                        <el-icon>
                            <edit />
                        </el-icon>
                        {{ LANG("Design/Modify Task~设计/修改任务") }}
                    </el-button>
                </el-col>
                <el-col :span="8">
                    <el-button type="warning" @click="startInvoke(lang)" size="large" class="w-100">
                        <el-icon>
                            <monitor />
                        </el-icon>
                        {{ LANG("View/Manage/Execute~查看/管理/执行") }}
                    </el-button>
                </el-col>
            </el-row>

            <!-- 搜索框 -->
            <div class="mb-12">
                <el-input v-model="search" :placeholder="LANG('Please input keywords to search~请输入关键词搜索')" class="w-100">
                    <template #prefix>
                        <el-icon>
                            <search />
                        </el-icon>
                    </template>
                </el-input>
            </div>

            <!-- 任务表格 -->
            <el-row>
                <el-col :span="24">
                    <el-table :data="list.filter(data => {
                    if (!search) return true;
                    const searchLower = search.toLowerCase();
                    return (((data.name || '').toLowerCase().includes(searchLower)) ||
                            ((data.url || '').toLowerCase().includes(searchLower)) ||
                            ((data.links || '').toLowerCase().includes(searchLower)) ||
                            ((data.desc || '').toLowerCase().includes(searchLower)) ||
                            ((data.id || '').toString().includes(searchLower)))
                })" border stripe empty-text="LANG('No Task~暂无任务')" style="width: 100%">
                    <el-table-column type="index" width="60" :label="LANG('序号')"></el-table-column>
                    <el-table-column prop="id" :label="LANG('Task ID~任务ID')" width="100" sortable></el-table-column>
                    <el-table-column prop="name" :label="LANG('Task Name~任务名称')" min-width="200" sortable show-overflow-tooltip></el-table-column>
                    <el-table-column prop="url" label="URL" min-width="300" sortable show-overflow-tooltip></el-table-column>
                    <el-table-column prop="links" :label="LANG('Links~链接')" min-width="150" sortable show-overflow-tooltip></el-table-column>
                    <el-table-column prop="desc" :label="LANG('Description~描述')" min-width="250" sortable show-overflow-tooltip></el-table-column>
                    <el-table-column :label="LANG('Operations~操作')" width="200" fixed="right">
                        <template #default="scope">
                            <el-button type="primary" size="small" @click="browseTask(scope.row)">{{ LANG("View~查看") }}</el-button>
                            <el-button v-if="type==3" type="success" size="small" @click="modifyTask(scope.row)">{{ LANG("Modify~修改") }}</el-button>
                            <el-button type="danger" size="small" @click="deleteTask(scope.row)">{{ LANG("Delete~删除") }}</el-button>
                        </template>
                    </el-table-column>
                </el-table>
                </el-col>
            </el-row>
        </div>
    </div>
    <!-- 引入 taskList.js 脚本（非模块化） -->
    <script src="js/taskList.js"></script>
</body>
</html>